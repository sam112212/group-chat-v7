
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; background: #f1f1f1; }
    input, select, button { padding: 8px; margin: 5px; }
    .avatar-grid { display: none; grid-template-columns: repeat(6, 1fr); gap: 5px; margin-top: 10px; }
    .avatar-grid span { cursor: pointer; font-size: 24px; border: 1px solid #ccc; padding: 5px; border-radius: 6px; }
    #adminFields { display: none; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>ğŸ™ï¸ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</h2>

  <div>ğŸŸ¢ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø§Ù„Ø¢Ù†: <span id="liveCount">--</span></div>

  <input type="text" id="name" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ"><br>

  <button onclick="document.getElementById('avatarGrid').style.display='grid'">ğŸ­ Ø§Ø®ØªØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©</button>
  <div id="avatarGrid" class="avatar-grid">
    <span onclick="selectAvatar('ğŸ‘¨')">ğŸ‘¨</span>
    <span onclick="selectAvatar('ğŸ‘©')">ğŸ‘©</span>
    <span onclick="selectAvatar('ğŸ‘§')">ğŸ‘§</span>
    <span onclick="selectAvatar('ğŸ‘¦')">ğŸ‘¦</span>
    <span onclick="selectAvatar('ğŸ‘´')">ğŸ‘´</span>
    <span onclick="selectAvatar('ğŸ‘µ')">ğŸ‘µ</span>
    <span onclick="selectAvatar('ğŸµ')">ğŸµ</span>
    <span onclick="selectAvatar('â¤ï¸')">â¤ï¸</span>
    <span onclick="selectAvatar('ğŸŒ™')">ğŸŒ™</span>
    <span onclick="selectAvatar('â­')">â­</span>
    <span onclick="selectAvatar('ğŸ§')">ğŸ§</span>
    <span onclick="selectAvatar('ğŸŒŸ')">ğŸŒŸ</span>
  </div>

  <div id="selectedAvatar" style="font-size: 24px; margin: 10px;"></div>

  <div>
    <button onclick="showAdmin()">ğŸ” Ø¯Ø®ÙˆÙ„ ÙƒØ¥Ø¯Ù…Ù†</button>
    <button onclick="hideAdmin()" style="display:none;" id="backBtn">â†©ï¸ Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ø¹Ø§Ø¯ÙŠ</button>
  </div>

  <div id="adminFields">
    <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"><br>
  </div>

  <button onclick="login()">ğŸšª Ø¯Ø®ÙˆÙ„</button>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    let avatar = '';

    function selectAvatar(emo) {
      avatar = emo;
      document.getElementById('selectedAvatar').textContent = 'ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ' + emo;
      document.getElementById('avatarGrid').style.display = 'none';
      localStorage.setItem('chosenAvatar', emo);
    }

    function showAdmin() {
      document.getElementById('adminFields').style.display = 'block';
      document.getElementById('backBtn').style.display = 'inline';
    }

    function hideAdmin() {
      document.getElementById('adminFields').style.display = 'none';
      document.getElementById('backBtn').style.display = 'none';
    }

    function login() {
      const name = document.getElementById('name').value.trim();
      const password = document.getElementById('password')?.value || '';
      if (!name) return alert('â— Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ');
      window.location.href = `/chat.html?name=${encodeURIComponent(name)}&password=${encodeURIComponent(password)}&avatar=${encodeURIComponent(avatar)}`;
    }

    socket.emit('get-current-count');
    socket.on('current-user-count', (count) => {
      document.getElementById('liveCount').textContent = count;
    });

    window.onload = () => {
      const saved = localStorage.getItem('chosenAvatar');
      if (saved) {
        avatar = saved;
        document.getElementById('selectedAvatar').textContent = 'ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ' + avatar;
      }
    };
  </script>
</body>
</html>
